import{ac as N,a as E,o as f,f as C,e as s,b as a,ag as $,q as R,V as h,L as M,ah as S,ai as q,I as v,aj as I,t as u,v as c,n as p,J as g,ak as L,al as P,am as y,Z as D,M as F,c as V,F as B,i as O,y as T,N as U,d,an as j,ao as J,Q,x as Z,ap as G,O as H,aq as K,ar as W,E as X,as as Y,at as ee}from"./main-RMm2V9W7.js";const ae={class:"d-flex align-start gap-3"},te={key:0},se={class:"text-sm font-weight-medium mb-1"},oe={class:"text-body-2 mb-2",style:{"letter-spacing":"0.4px !important","line-height":"18px"}},ie={class:"text-sm text-disabled mb-0",style:{"letter-spacing":"0.4px !important","line-height":"18px"}},le={class:"d-flex flex-column align-end"},ne={__name:"Notifications",props:{notifications:{type:Array,required:!0},badgeProps:{type:Object,required:!1,default:void 0},location:{type:null,required:!1,default:"bottom end"}},emits:["read","unread","remove","click:notification"],setup(w,{emit:k}){const o=w,r=k,m=N(()=>o.notifications.some(e=>e.read_at===null)),_=()=>{const e=o.notifications.map(i=>i.id);m.value?r("read",e):r("unread",e)},x=N(()=>o.notifications.filter(e=>e.read_at===null).length),b=(e,i)=>{e?r("unread",[i]):r("read",[i])},n=e=>`https://darby-dash.sublimelogics.com/storage/${e}`;return(e,i)=>{const l=E("IconBtn");return f(),C(l,{id:"notification-btn"},{default:s(()=>[a($,R(o.badgeProps,{"model-value":o.notifications.some(t=>!t.read_at),color:"primary",dot:"","offset-x":"2","offset-y":"3"}),{default:s(()=>[a(h,{size:"24",icon:"tabler-bell"})]),_:1},16,["model-value"]),a(M,{activator:"parent",width:"380px",location:o.location,offset:"12px","close-on-content-click":!1},{default:s(()=>[a(S,{class:"d-flex flex-column"},{default:s(()=>[a(q,{class:"notification-section"},{append:s(()=>[v(a(I,{size:"small",color:"primary",class:"me-2"},{default:s(()=>[u(c(p(x))+" New ",1)]),_:1},512),[[g,o.notifications.some(t=>!t.read_at)]]),v(a(l,{size:"34",onClick:_},{default:s(()=>[a(h,{size:"20",color:"high-emphasis",icon:p(m)?"tabler-mail-opened":"tabler-mail"},null,8,["icon"]),a(L,{activator:"parent",location:"start"},{default:s(()=>[u(c(p(m)?"Mark all as read":"Mark all as unread"),1)]),_:1})]),_:1},512),[[g,o.notifications.length]])]),default:s(()=>[a(P,{class:"text-h6"},{default:s(()=>[u(" Notifications ")]),_:1})]),_:1}),a(y),a(p(D),{options:{wheelPropagation:!1},style:{"max-block-size":"23.75rem"}},{default:s(()=>[a(F,{class:"notification-list rounded-0 py-0"},{default:s(()=>[(f(!0),V(B,null,O(o.notifications,(t,A)=>(f(),V(B,{key:t.title},[A>0?(f(),C(y,{key:0})):T("",!0),a(U,{link:"",lines:"one","min-height":"66px",class:"list-item-hover-class",onClick:z=>e.$emit("click:notification",t)},{default:s(()=>[d("div",ae,[a($,{dot:"",location:"top end","offset-x":"0","offset-y":"1",color:t.is_online?"success":"warning"},{default:s(()=>[a(j,{size:"34",color:"primary",image:n(t.img.path)||void 0,variant:t.img?void 0:"tonal"},{default:s(()=>[t.img?T("",!0):(f(),V("span",te,c(("avatarText"in e?e.avatarText:p(J))(t.name)),1))]),_:2},1032,["image","variant"])]),_:2},1032,["color"]),d("div",null,[d("p",se,c(t.title),1),d("p",oe,c(t.subtitle),1),d("p",ie,c(t.time),1)]),a(Q),d("div",le,[a(h,{size:"10",icon:"tabler-circle-filled",color:t.read_at?"#a8aaae":"primary",class:Z([`${t.read_at?"visible-in-hover":""}`,"mb-2"]),onClick:G(z=>b(t.read_at,t.id),["stop"])},null,8,["color","class","onClick"]),a(h,{size:"20",icon:"tabler-x",class:"visible-in-hover",onClick:z=>e.$emit("remove",t.id)},null,8,["onClick"])])])]),_:2},1032,["onClick"])],64))),128)),v(a(U,{class:"text-center text-medium-emphasis",style:{"block-size":"56px"}},{default:s(()=>[a(H,null,{default:s(()=>[u("No Notification Found!")]),_:1})]),_:1},512),[[g,!o.notifications.length]])]),_:1})]),_:1}),a(y),v(a(K,{class:"pa-4"},{default:s(()=>[a(W,{block:"",size:"small",to:{path:"/view/received/notifications"}},{default:s(()=>[u(" View All Notifications ")]),_:1})]),_:1},512),[[g,o.notifications.length]])]),_:1})]),_:1},8,["location"])]),_:1})}}},ce={__name:"NavBarNotifications",setup(w){X(async()=>{await r()});const k=Y(),o=ee(),r=async()=>{try{await o.getAll()}catch(e){k.error("Error fetching notifications:",e)}},m=e=>{n.value.forEach((i,l)=>{e===i.id&&n.value.splice(l,1),o.delete(e)})},_=e=>{n.value.forEach(i=>{e.forEach(l=>{l===i.id&&o.markAsRead({ids:e})})})},x=e=>{n.value.forEach(i=>{e.forEach(l=>{l===i.id&&o.markAsUnread({ids:e})})})},b=e=>{e.read_at||_([e.id])},n=N(()=>o.getNotifications);return(e,i)=>{const l=ne;return f(),C(l,{notifications:n.value,onRemove:m,onRead:_,onUnread:x,"onClick:notification":b},null,8,["notifications"])}}};export{ce as default};
