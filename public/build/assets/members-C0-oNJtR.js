import{bI as ge,bJ as Ve,_ as be,bK as ye,bL as we,r as d,bM as _e,a3 as q,a as Se,o as w,c as M,b as a,e as s,ar as j,ae as T,F as Ce,as as n,aW as X,an as R,q as he,a4 as O,t as h,aR as G,al as H,am as P,n as o,bN as m,bO as Z,bP as ke,bQ as Y,ai as qe,bR as Me,d as v,aj as Pe,x as Fe,v as F,ak as Ue,f as ee,ag as ae,y as Ee,bS as Re,bT as De,aX as Ae,bk as $e,bU as Be,bV as Ie,R as ze,U as Le}from"./main-BweXWrEl.js";const Ne={getRoles(){return ge.get("/roles")}},je=Ve("roles",{state:()=>({roles:[],rolesIds:[],loadStatus:0,error:null}),persist:!0,actions:{async getAll(){this.error=null,this.loadStatus=1;try{const i=await Ne.getRoles();this.roles=i.data.data.map(f=>({name:f.name})),this.loadStatus=2}catch(i){this.error=i,this.loadStatus=3,console.error("getRoles error ",i)}},capitalizeFirstLetter(i){return i.charAt(0).toUpperCase()+i.slice(1)}},getters:{getLoadStatus:i=>i.loadStatus,getRoles:i=>i.roles,getErrors:i=>i.error}}),le=i=>(ze("data-v-dcca482b"),i=i(),Le(),i),Te={key:0},Oe={key:1},Ye={key:0},xe={key:1},Je=le(()=>v("h5",{class:"text-h5"}," Manage Members ",-1)),Ke=le(()=>v("div",{style:{"inline-size":"272px"}},null,-1)),Qe={class:"d-flex align-center"},We={class:"d-flex flex-column ms-3"},Xe={class:"d-block font-weight-medium text-high-emphasis text-sm text-truncate"},Ge={class:"mt-0"},He={class:"d-flex gap-1"},Ze={class:"text-sm text-truncate mb-0"},ea={class:"d-flex gap-1"},aa={class:"d-flex gap-1"},la={class:"text-sm text-truncate mb-0"},ta={class:"d-flex"},sa={key:0,class:"text-center"},ra={__name:"members",setup(i){const f=ye(),I=je(),V=we(),z=d(),L=d(),k=d(!1),_=d(!1),D=d(!1),A=d(!1),x=d(0),r=d({name_first:"",name_last:"",email:"",role:"",phone:"",password:"",confirmPassword:"",state:""}),u=d({}),c=d(!1),te=d(""),S=d({page:1,itemsPerPage:10,sortBy:[""],sortDesc:[!1]}),se=l=>Re(l).format("MMM DD, YYYY"),re=[{title:"Name",key:"name",sortable:!1},{title:"Email",key:"email",sortable:!1},{title:"Status",key:"state",sortable:!1,width:"15%"},{title:"Created At",key:"created_at",sortable:!0,width:"20%"},{title:"Actions",key:"actions",sortable:!1,width:"5%"}];_e(async()=>{await de(),await U(),x.value=ve.value});const p=d({name_first:"",name_last:"",email:"",role:"",phone:"",password:"",confirmPassword:"",state:""}),b=d({name_first:"",name_last:"",email:"",role:"",phone:"",state:""}),U=async()=>{try{await V.getAll(S.value.page,S.value.itemsPerPage),c.value=!0}catch(l){f.error("Error fetching members:",l)}finally{c.value=!1}};async function oe(){var l;(l=z.value)==null||l.validate().then(async({valid:e})=>{if(e)try{N("addingErrors"),await V.create(r.value),E.value?J("addingForm"):(k.value=!1,c.value=!0,f.success("Member added successfully",{timeout:1e3}),await U(),N("addingForm"),c.value=!1)}catch(y){f.error("Failed to add member:",y)}})}const ie=l=>{const{roles:e,...y}=l;u.value={...y,role:e[0]},_.value=!0};async function ne(){var l;(l=L.value)==null||l.validate().then(async({valid:e})=>{if(e)try{N("editErrors"),await V.update(u.value),E.value?J("editForm"):(_.value=!1,c.value=!0,f.success("Member updated successfully",{timeout:1e3}),await U(),c.value=!1)}catch(y){f.error("Failed to update member:",y.message||y)}})}const ue=async l=>{try{(await De.fire({title:"Are you sure?",text:`Do you want to delete ${l.name_first} ${l.name_last}?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"})).isConfirmed&&(await V.delete(l.uuid),E.value?f.error("Something went wrong. Please try again later."):(c.value=!0,f.success("Member deleted successfully",{timeout:1e3}),await U(),c.value=!1))}catch(e){f.error("Failed to delete member:",e.message||e)}},de=async()=>{try{c.value=!0,await I.getAll()}catch(l){f.error("Failed to get roles:",l.message||l)}finally{c.value=!1}},J=l=>{fe.value===500?f.error("Something went wrong. Please try again later."):(l==="addingForm"&&(p.value=E.value),l==="editForm"&&(b.value=E.value))},N=l=>{l==="addingErrors"&&(p.value=Object.fromEntries(Object.keys(p.value).map(e=>[e,""]))),l==="addingErrors"&&(b.value=Object.fromEntries(Object.keys(b.value).map(e=>[e,""]))),l==="addingForm"&&(r.value=Object.fromEntries(Object.keys(r.value).map(e=>[e,""])))},K=q(()=>I.getRoles),me=q(()=>V.getUsers),E=q(()=>V.getErrors),ve=q(()=>V.usersCount),fe=q(()=>V.getStatusCode),$=q(()=>V.getLoadStatus),Q=()=>"#"+Math.floor(Math.random()*16777215).toString(16).padStart(-50,"0"),ce=async l=>{S.value.page=l,await U()};return(l,e)=>{const y=Ae,g=$e,B=Be,W=Se("IconBtn"),pe=Ie;return w(),M(Ce,null,[a(j,null,{default:s(()=>[a(n,{cols:"12",md:"6"}),a(n,{cols:"12",md:"6",class:"mb-3"},{default:s(()=>[a(X,{modelValue:k.value,"onUpdate:modelValue":e[13]||(e[13]=t=>k.value=t),persistent:"",class:"v-dialog-sm"},{activator:s(({props:t})=>[a(R,he({color:"primary",size:"small",rounded:"pill",class:"float-right"},t),{default:s(()=>[a(O,{start:"",icon:"tabler-plus"}),h(" New Member ")]),_:2},1040)]),default:s(()=>[a(y,{onClick:e[0]||(e[0]=t=>k.value=!k.value)}),a(T,{title:"Add Member Details"},{default:s(()=>[a(G,{ref_key:"addMemberForm",ref:z,onSubmit:H(oe,["prevent"])},{default:s(()=>[a(P,null,{default:s(()=>[a(j,null,{default:s(()=>[a(n,{cols:"6"},{default:s(()=>[a(g,{modelValue:r.value.name_first,"onUpdate:modelValue":e[1]||(e[1]=t=>r.value.name_first=t),label:"First Name",rules:["requiredValidator"in l?l.requiredValidator:o(m)],"error-messages":p.value.name_first},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"6"},{default:s(()=>[a(g,{modelValue:r.value.name_last,"onUpdate:modelValue":e[2]||(e[2]=t=>r.value.name_last=t),label:"Last Name",rules:["requiredValidator"in l?l.requiredValidator:o(m)],"error-messages":p.value.name_last},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"6"},{default:s(()=>[a(g,{modelValue:r.value.email,"onUpdate:modelValue":e[3]||(e[3]=t=>r.value.email=t),label:"Email",rules:["requiredValidator"in l?l.requiredValidator:o(m),"emailValidator"in l?l.emailValidator:o(Z)],"error-messages":p.value.email},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"6"},{default:s(()=>[a(g,{modelValue:r.value.phone,"onUpdate:modelValue":e[4]||(e[4]=t=>r.value.phone=t),type:"number",label:"Phone",rules:["requiredValidator"in l?l.requiredValidator:o(m)],"error-messages":p.value.phone},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"6"},{default:s(()=>[a(B,{modelValue:r.value.role,"onUpdate:modelValue":e[5]||(e[5]=t=>r.value.role=t),label:"Select Role",placeholder:"Select Role",items:K.value,"item-title":"name","item-value":"name",rules:["requiredValidator"in l?l.requiredValidator:o(m)],"error-messages":p.value.role},null,8,["modelValue","items","rules","error-messages"])]),_:1}),a(n,{cols:"6"},{default:s(()=>[a(g,{modelValue:r.value.password,"onUpdate:modelValue":e[6]||(e[6]=t=>r.value.password=t),label:"Password",type:D.value?"text":"password","append-inner-icon":D.value?"tabler-eye-off":"tabler-eye",rules:["requiredValidator"in l?l.requiredValidator:o(m)],"error-messages":p.value.password,"onClick:appendInner":e[7]||(e[7]=t=>D.value=!D.value)},null,8,["modelValue","type","append-inner-icon","rules","error-messages"])]),_:1}),a(n,{cols:"6"},{default:s(()=>[a(g,{modelValue:r.value.confirmPassword,"onUpdate:modelValue":e[8]||(e[8]=t=>r.value.confirmPassword=t),type:A.value?"text":"password",label:"Confirm Password","append-inner-icon":A.value?"tabler-eye-off":"tabler-eye",rules:["requiredValidator"in l?l.requiredValidator:o(m),("confirmedValidator"in l?l.confirmedValidator:o(ke))(r.value.confirmPassword,r.value.password)],"error-messages":p.value.confirmPassword,"onClick:appendInner":e[9]||(e[9]=t=>A.value=!A.value)},null,8,["modelValue","type","append-inner-icon","rules","error-messages"])]),_:1}),a(n,{cols:"6"},{default:s(()=>[a(B,{modelValue:r.value.state,"onUpdate:modelValue":e[10]||(e[10]=t=>r.value.state=t),label:"Select Status",placeholder:"Select Status",items:[{title:"Active",value:"active"},{title:"Inactive",value:"inactive"}],"item-title":"title","item-value":"value",rules:["requiredValidator"in l?l.requiredValidator:o(m)],"error-messages":p.value.state},null,8,["modelValue","rules","error-messages"])]),_:1})]),_:1})]),_:1}),a(P,{class:"d-flex justify-end gap-3 flex-wrap"},{default:s(()=>[a(R,{color:"secondary",onClick:e[11]||(e[11]=t=>k.value=!1)},{default:s(()=>[h(" Cancel ")]),_:1}),a(R,{type:"submit",disabled:$.value===1,onClick:e[12]||(e[12]=t=>{var C;return(C=z.value)==null?void 0:C.validate()})},{default:s(()=>[$.value===1?(w(),M("span",Te,[h(" Loading... "),a(Y,{size:20,width:"3",indeterminate:""})])):(w(),M("span",Oe," Add "))]),_:1},8,["disabled"])]),_:1})]),_:1},512)]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(X,{modelValue:_.value,"onUpdate:modelValue":e[23]||(e[23]=t=>_.value=t),persistent:"",class:"v-dialog-sm"},{default:s(()=>[a(y,{onClick:e[14]||(e[14]=t=>_.value=!_.value)}),a(T,{title:"Edit Member Details"},{default:s(()=>[a(G,{ref_key:"editMemberForm",ref:L,onSubmit:H(ne,["prevent"])},{default:s(()=>[a(P,null,{default:s(()=>[a(j,null,{default:s(()=>[a(n,{cols:"6"},{default:s(()=>[a(g,{modelValue:u.value.name_first,"onUpdate:modelValue":e[15]||(e[15]=t=>u.value.name_first=t),label:"First Name",rules:["requiredValidator"in l?l.requiredValidator:o(m)],"error-messages":b.value.name_first},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"6"},{default:s(()=>[a(g,{modelValue:u.value.name_last,"onUpdate:modelValue":e[16]||(e[16]=t=>u.value.name_last=t),label:"Last Name",rules:["requiredValidator"in l?l.requiredValidator:o(m)],"error-messages":b.value.name_last},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"6"},{default:s(()=>[a(g,{modelValue:u.value.email,"onUpdate:modelValue":e[17]||(e[17]=t=>u.value.email=t),label:"Email",rules:["requiredValidator"in l?l.requiredValidator:o(m),"emailValidator"in l?l.emailValidator:o(Z)],"error-messages":b.value.email},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"6"},{default:s(()=>[a(g,{modelValue:u.value.phone,"onUpdate:modelValue":e[18]||(e[18]=t=>u.value.phone=t),label:"Phone",rules:["requiredValidator"in l?l.requiredValidator:o(m)],"error-messages":b.value.phone},null,8,["modelValue","rules","error-messages"])]),_:1}),a(n,{cols:"6"},{default:s(()=>[a(B,{modelValue:u.value.role,"onUpdate:modelValue":e[19]||(e[19]=t=>u.value.role=t),label:"Select Role",placeholder:"Select Role",items:K.value,"item-title":"name","item-value":"name",rules:["requiredValidator"in l?l.requiredValidator:o(m)],"error-messages":b.value.role},null,8,["modelValue","items","rules","error-messages"])]),_:1}),a(n,{cols:"6"},{default:s(()=>[a(B,{modelValue:u.value.state,"onUpdate:modelValue":e[20]||(e[20]=t=>u.value.state=t),label:"Select Status",placeholder:"Select Status",items:[{title:"Active",value:"active"},{title:"Inactive",value:"inactive"}],"item-title":"title","item-value":"value",rules:["requiredValidator"in l?l.requiredValidator:o(m)],"error-messages":b.value.state},null,8,["modelValue","rules","error-messages"])]),_:1})]),_:1})]),_:1}),a(P,{class:"d-flex justify-end gap-3 flex-wrap"},{default:s(()=>[a(R,{color:"secondary",onClick:e[21]||(e[21]=t=>_.value=!1)},{default:s(()=>[h(" Cancel ")]),_:1}),a(R,{type:"submit",disabled:$.value===1,onClick:e[22]||(e[22]=t=>{var C;return(C=L.value)==null?void 0:C.validate()})},{default:s(()=>[$.value===1?(w(),M("span",Ye,[h(" Loading... "),a(Y,{size:20,width:"3",indeterminate:""})])):(w(),M("span",xe," Save "))]),_:1},8,["disabled"])]),_:1})]),_:1},512)]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(T,null,{default:s(()=>[a(P,{class:"d-flex justify-space-between align-center flex-wrap gap-4"},{default:s(()=>[Je,Ke]),_:1}),a(qe),a(Me,{headers:re,"items-per-page":S.value.itemsPerPage,items:me.value,"item-value":"name","hide-default-footer":"",search:te.value,class:"text-no-wrap",density:"compact"},{"item.name":s(({item:t})=>[v("div",Qe,[a(Pe,{size:"36",color:t.avatar?"":Q(),class:Fe(t.avatar?"":"v-avatar-light-bg info--text"),variant:t.avatar?Q():"tonal"},{default:s(()=>[v("span",null,F(("avatarText"in l?l.avatarText:o(Ue))(t.name_first+" "+t.name_last)),1)]),_:2},1032,["color","class","variant"]),v("div",We,[v("span",Xe,F(t.name_first)+" "+F(t.name_last),1),v("small",Ge,F(o(I).capitalizeFirstLetter(t.roles[0])),1)])])]),"item.email":s(({item:t})=>[v("div",He,[v("span",Ze,F(t.email),1)])]),"item.state":s(({item:t})=>[v("div",ea,[t.state=="active"?(w(),ee(ae,{key:0,color:"success",variant:"outlined",size:"small"},{default:s(()=>[h(" Active ")]),_:1})):(w(),ee(ae,{key:1,color:"error",variant:"outlined",size:"small"},{default:s(()=>[h(" Inactive ")]),_:1}))])]),"item.created_at":s(({item:t})=>[v("div",aa,[v("span",la,F(se(t)),1)])]),"item.actions":s(({item:t})=>[v("div",ta,[a(W,{onClick:C=>ie(t)},{default:s(()=>[a(O,{icon:"tabler-edit",color:"info"})]),_:2},1032,["onClick"]),a(W,{onClick:C=>ue(t)},{default:s(()=>[a(O,{icon:"tabler-trash",color:"error"})]),_:2},1032,["onClick"])])]),bottom:s(()=>[a(P,{class:"pt-2"},{default:s(()=>[c.value?(w(),M("div",sa,[a(Y,{size:30,width:"3",indeterminate:"",color:"primary"})])):Ee("",!0)]),_:1}),a(pe,{page:S.value.page,"onUpdate:page":[e[24]||(e[24]=t=>S.value.page=t),ce],"items-per-page":S.value.itemsPerPage,"total-items":x.value},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","items","search"])]),_:1})],64)}}},ia=be(ra,[["__scopeId","data-v-dcca482b"]]);export{ia as default};
