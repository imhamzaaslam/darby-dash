import{k as M,ac as C,a as S,o as f,f as w,e as s,b as a,ag as T,q,V as h,L as I,ah as L,ai as P,I as v,aj as D,t as p,v as m,n as _,J as g,ak as F,al as O,am as V,Z as j,M as J,c as N,F as U,i as Q,y as $,N as A,d as u,an as Z,ao as G,Q as H,x as K,ap as W,O as X,aq as Y,ar as ee,E as ae,as as te,at as se}from"./main-pguH9mP-.js";const oe={class:"d-flex align-start gap-3"},ie={key:0},le={class:"text-sm font-weight-medium mb-1"},ne={class:"text-body-2 mb-2",style:{"letter-spacing":"0.4px !important","line-height":"18px"}},re={class:"text-sm text-disabled mb-0",style:{"letter-spacing":"0.4px !important","line-height":"18px"}},ce={class:"d-flex flex-column align-end"},de={__name:"Notifications",props:{notifications:{type:Array,required:!0},badgeProps:{type:Object,required:!1,default:void 0},location:{type:null,required:!1,default:"bottom end"}},emits:["read","unread","remove","click:notification"],setup(z,{emit:k}){const o=z,n=k,x=M(),c=C(()=>o.notifications.some(e=>e.read_at===null)),b=async e=>{n("click:notification",e),e.url&&x.push(e.url)},y=()=>{const e=o.notifications.map(d=>d.id);c.value?n("read",e):n("unread",e)},r=C(()=>o.notifications.filter(e=>e.read_at===null).length),i=(e,d)=>{e?n("unread",[d]):n("read",[d])},l=e=>`https://darby-dash.sublimelogics.com/storage/${e}`;return(e,d)=>{const B=S("IconBtn");return f(),w(B,{id:"notification-btn"},{default:s(()=>[a(T,q(o.badgeProps,{"model-value":o.notifications.some(t=>!t.read_at),color:"primary",dot:"","offset-x":"2","offset-y":"3",class:"animated-badge"}),{default:s(()=>[a(h,{size:"24",icon:"tabler-bell"})]),_:1},16,["model-value"]),a(I,{activator:"parent",width:"380px",location:o.location,offset:"12px","close-on-content-click":!1},{default:s(()=>[a(L,{class:"d-flex flex-column"},{default:s(()=>[a(P,{class:"notification-section"},{append:s(()=>[v(a(D,{size:"small",color:"primary",class:"me-2"},{default:s(()=>[p(m(_(r))+" New ",1)]),_:1},512),[[g,o.notifications.some(t=>!t.read_at)]]),v(a(B,{size:"34",onClick:y},{default:s(()=>[a(h,{size:"20",color:"high-emphasis",icon:_(c)?"tabler-mail-opened":"tabler-mail"},null,8,["icon"]),a(F,{activator:"parent",location:"start"},{default:s(()=>[p(m(_(c)?"Mark all as read":"Mark all as unread"),1)]),_:1})]),_:1},512),[[g,o.notifications.length]])]),default:s(()=>[a(O,{class:"text-h6"},{default:s(()=>[p(" Notifications ")]),_:1})]),_:1}),a(V),a(_(j),{options:{wheelPropagation:!1},style:{"max-block-size":"23.75rem"}},{default:s(()=>[a(J,{class:"notification-list rounded-0 py-0"},{default:s(()=>[(f(!0),N(U,null,Q(o.notifications,(t,E)=>(f(),N(U,{key:t.title},[E>0?(f(),w(V,{key:0})):$("",!0),a(A,{link:"",lines:"one","min-height":"66px",class:"list-item-hover-class",onClick:R=>b(t)},{default:s(()=>[u("div",oe,[a(T,{dot:"",location:"top end","offset-x":"0","offset-y":"1",color:t.is_online?"success":"warning"},{default:s(()=>[a(Z,{size:"34",color:"primary",image:t.img?l(t.img.path):void 0,variant:t.img?void 0:"tonal"},{default:s(()=>[t.img?$("",!0):(f(),N("span",ie,m(("avatarText"in e?e.avatarText:_(G))(t.name)),1))]),_:2},1032,["image","variant"])]),_:2},1032,["color"]),u("div",null,[u("p",le,m(t.title),1),u("p",ne,m(t.subtitle),1),u("p",re,m(t.time),1)]),a(H),u("div",ce,[a(h,{size:"10",icon:"tabler-circle-filled",color:t.read_at?"#a8aaae":"primary",class:K([`${t.read_at?"visible-in-hover":""}`,"mb-2"]),onClick:W(R=>i(t.read_at,t.id),["stop"])},null,8,["color","class","onClick"]),a(h,{size:"20",icon:"tabler-x",class:"visible-in-hover",onClick:R=>e.$emit("remove",t.id)},null,8,["onClick"])])])]),_:2},1032,["onClick"])],64))),128)),v(a(A,{class:"text-center text-medium-emphasis",style:{"block-size":"56px"}},{default:s(()=>[a(X,null,{default:s(()=>[p("No Notification Found!")]),_:1})]),_:1},512),[[g,!o.notifications.length]])]),_:1})]),_:1}),a(V),v(a(Y,{class:"pa-4"},{default:s(()=>[a(ee,{block:"",size:"small",to:{path:"/view/received/notifications"}},{default:s(()=>[p(" View All Notifications ")]),_:1})]),_:1},512),[[g,o.notifications.length]])]),_:1})]),_:1},8,["location"])]),_:1})}}},ue={__name:"NavBarNotifications",setup(z){ae(async()=>{await n()});const k=te(),o=se(),n=async()=>{try{await o.getAll()}catch(i){k.error("Error fetching notifications:",i)}},x=i=>{r.value.forEach((l,e)=>{i===l.id&&r.value.splice(e,1),o.delete(i)})},c=i=>{r.value.forEach(l=>{i.forEach(e=>{e===l.id&&o.markAsRead({ids:i})})})},b=i=>{r.value.forEach(l=>{i.forEach(e=>{e===l.id&&o.markAsUnread({ids:i})})})},y=i=>{i.read_at||c([i.id])},r=C(()=>o.getNotifications);return(i,l)=>{const e=de;return f(),w(e,{notifications:r.value,onRemove:x,onRead:c,onUnread:b,"onClick:notification":y},null,8,["notifications"])}}};export{ue as default};
