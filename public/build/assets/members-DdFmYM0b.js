import{bI as ue,bJ as de,_ as me,bK as ve,bL as fe,r as p,bM as ce,a3 as R,a as pe,o as D,c as j,b as e,e as s,ar as I,ae as E,F as Ve,as as n,aW as x,an as M,q as be,a4 as N,t as S,aR as J,al as K,am as _,n as o,bN as d,bO as O,bP as ge,ai as ye,bQ as we,d as f,aj as Se,x as Ce,v as q,ak as _e,f as Q,ag as W,bR as qe,y as ke,bS as Me,bT as he,aX as Ue,bk as Pe,bU as Re,bV as De,R as Fe,U as Ae}from"./main-D6SQ38NU.js";const $e={getRoles(){return ue.get("/roles")}},Be=de("roles",{state:()=>({roles:[],rolesIds:[],loadStatus:0,error:null}),persist:!0,actions:{async getAll(){this.error=null,this.loadStatus=1;try{const i=await $e.getRoles();this.roles=i.data.data.map(m=>({name:m.name})),this.loadStatus=2}catch(i){this.error=i,this.loadStatus=3,console.error("getRoles error ",i)}},capitalizeFirstLetter(i){return i.charAt(0).toUpperCase()+i.slice(1)}},getters:{getLoadStatus:i=>i.loadStatus,getRoles:i=>i.roles,getErrors:i=>i.error}}),X=i=>(Fe("data-v-de8215d0"),i=i(),Ae(),i),Ie=X(()=>f("h5",{class:"text-h5"}," Manage Members ",-1)),Ee=X(()=>f("div",{style:{"inline-size":"272px"}},null,-1)),Ne={class:"d-flex align-center"},Te={class:"d-flex flex-column ms-3"},ze={class:"d-block font-weight-medium text-high-emphasis text-sm text-truncate"},Le={class:"mt-0"},Ye={class:"d-flex gap-1"},je={class:"text-sm text-truncate mb-0"},xe={class:"d-flex gap-1"},Je={class:"d-flex gap-1"},Ke={class:"text-sm text-truncate mb-0"},Oe={class:"d-flex"},Qe={key:0,class:"text-center"},We={__name:"members",setup(i){const m=ve(),F=Be(),b=fe(),A=p(),$=p(),C=p(!1),g=p(!1),h=p(!1),U=p(!1),T=p(0),r=p({name_first:"",name_last:"",email:"",role:"",phone:"",password:"",confirmPassword:"",state:""}),u=p({}),V=p(!1),G=p(""),y=p({page:1,itemsPerPage:10,sortBy:[""],sortDesc:[!1]}),H=t=>Me(t).format("MMM DD, YYYY"),Z=[{title:"Name",key:"name",sortable:!1},{title:"Email",key:"email",sortable:!1},{title:"Status",key:"state",sortable:!1,width:"15%"},{title:"Created At",key:"created_at",sortable:!0,width:"20%"},{title:"Actions",key:"actions",sortable:!1,width:"5%"}];ce(async()=>{await se(),await k(),T.value=oe.value});const k=async()=>{try{await b.getAll(y.value.page,y.value.itemsPerPage),V.value=!0}catch(t){m.error("Error fetching members:",t)}finally{V.value=!1}};async function ee(){var t;(t=A.value)==null||t.validate().then(async({valid:l})=>{if(l)try{const c=await b.create(r.value);B.value?m.error("Something went wrong."):(C.value=!1,V.value=!0,m.success("Member added successfully",{timeout:1e3}),await k(),V.value=!1)}catch(c){m.error("Failed to add member:",c)}})}const ae=t=>{const{roles:l,...c}=t;u.value={...c,role:l[0]},g.value=!0};async function le(){var t;(t=$.value)==null||t.validate().then(async({valid:l})=>{if(l)try{const c=await b.update(u.value);B.value?m.error("Something went wrong."):(g.value=!1,V.value=!0,m.success("Member updated successfully",{timeout:1e3}),await k(),V.value=!1)}catch(c){m.error("Failed to update member:",c.message||c)}})}const te=async t=>{try{if((await he.fire({title:"Are you sure?",text:`Do you want to delete ${t.name_first} ${t.name_last}?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"})).isConfirmed){const c=await b.delete(t.uuid);B.value?m.error("Something went wrong."):(V.value=!0,m.success("Member deleted successfully",{timeout:1e3}),await k(),V.value=!1)}}catch(l){m.error("Failed to delete member:",l.message||l)}},se=async()=>{try{V.value=!0,await F.getAll()}catch(t){m.error("Failed to get roles:",t.message||t)}finally{V.value=!1}},z=R(()=>F.getRoles),re=R(()=>b.getUsers),B=R(()=>b.getErrors),oe=R(()=>b.usersCount),L=()=>"#"+Math.floor(Math.random()*16777215).toString(16).padStart(-50,"0"),ie=async t=>{y.value.page=t,await k()};return(t,l)=>{const c=Ue,v=Pe,P=Re,Y=pe("IconBtn"),ne=De;return D(),j(Ve,null,[e(I,null,{default:s(()=>[e(n,{cols:"12",md:"6"}),e(n,{cols:"12",md:"6",class:"mb-3"},{default:s(()=>[e(x,{modelValue:C.value,"onUpdate:modelValue":l[13]||(l[13]=a=>C.value=a),persistent:"",class:"v-dialog-sm"},{activator:s(({props:a})=>[e(M,be({color:"primary",size:"small",rounded:"pill",class:"float-right"},a),{default:s(()=>[e(N,{start:"",icon:"tabler-plus"}),S(" New Member ")]),_:2},1040)]),default:s(()=>[e(c,{onClick:l[0]||(l[0]=a=>C.value=!C.value)}),e(E,{title:"Add Member Details"},{default:s(()=>[e(J,{ref_key:"addMemberForm",ref:A,onSubmit:K(ee,["prevent"])},{default:s(()=>[e(_,null,{default:s(()=>[e(I,null,{default:s(()=>[e(n,{cols:"6"},{default:s(()=>[e(v,{modelValue:r.value.name_first,"onUpdate:modelValue":l[1]||(l[1]=a=>r.value.name_first=a),rules:["requiredValidator"in t?t.requiredValidator:o(d)],label:"First Name"},null,8,["modelValue","rules"])]),_:1}),e(n,{cols:"6"},{default:s(()=>[e(v,{modelValue:r.value.name_last,"onUpdate:modelValue":l[2]||(l[2]=a=>r.value.name_last=a),rules:["requiredValidator"in t?t.requiredValidator:o(d)],label:"Last Name"},null,8,["modelValue","rules"])]),_:1}),e(n,{cols:"6"},{default:s(()=>[e(v,{modelValue:r.value.email,"onUpdate:modelValue":l[3]||(l[3]=a=>r.value.email=a),rules:["requiredValidator"in t?t.requiredValidator:o(d),"emailValidator"in t?t.emailValidator:o(O)],label:"Email"},null,8,["modelValue","rules"])]),_:1}),e(n,{cols:"6"},{default:s(()=>[e(v,{modelValue:r.value.phone,"onUpdate:modelValue":l[4]||(l[4]=a=>r.value.phone=a),type:"number",rules:["requiredValidator"in t?t.requiredValidator:o(d)],label:"Phone"},null,8,["modelValue","rules"])]),_:1}),e(n,{cols:"6"},{default:s(()=>[e(P,{modelValue:r.value.role,"onUpdate:modelValue":l[5]||(l[5]=a=>r.value.role=a),label:"Select Role",placeholder:"Select Role",rules:["requiredValidator"in t?t.requiredValidator:o(d)],items:z.value,"item-title":"name","item-value":"name"},null,8,["modelValue","rules","items"])]),_:1}),e(n,{cols:"6"},{default:s(()=>[e(v,{modelValue:r.value.password,"onUpdate:modelValue":l[6]||(l[6]=a=>r.value.password=a),rules:["requiredValidator"in t?t.requiredValidator:o(d)],label:"Password",type:h.value?"text":"password","append-inner-icon":h.value?"tabler-eye-off":"tabler-eye","onClick:appendInner":l[7]||(l[7]=a=>h.value=!h.value)},null,8,["modelValue","rules","type","append-inner-icon"])]),_:1}),e(n,{cols:"6"},{default:s(()=>[e(v,{modelValue:r.value.confirmPassword,"onUpdate:modelValue":l[8]||(l[8]=a=>r.value.confirmPassword=a),type:U.value?"text":"password",rules:["requiredValidator"in t?t.requiredValidator:o(d),("confirmedValidator"in t?t.confirmedValidator:o(ge))(r.value.confirmPassword,r.value.password)],label:"Confirm Password","append-inner-icon":U.value?"tabler-eye-off":"tabler-eye","onClick:appendInner":l[9]||(l[9]=a=>U.value=!U.value)},null,8,["modelValue","type","rules","append-inner-icon"])]),_:1}),e(n,{cols:"6"},{default:s(()=>[e(P,{modelValue:r.value.state,"onUpdate:modelValue":l[10]||(l[10]=a=>r.value.state=a),label:"Select Status",placeholder:"Select Status",rules:["requiredValidator"in t?t.requiredValidator:o(d)],items:[{title:"Active",value:"active"},{title:"Inactive",value:"inactive"}],"item-title":"title","item-value":"value"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1}),e(_,{class:"d-flex justify-end gap-3 flex-wrap"},{default:s(()=>[e(M,{color:"secondary",onClick:l[11]||(l[11]=a=>C.value=!1)},{default:s(()=>[S(" Cancel ")]),_:1}),e(M,{type:"submit",onClick:l[12]||(l[12]=a=>{var w;return(w=A.value)==null?void 0:w.validate()})},{default:s(()=>[S(" Add ")]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(x,{modelValue:g.value,"onUpdate:modelValue":l[23]||(l[23]=a=>g.value=a),persistent:"",class:"v-dialog-sm"},{default:s(()=>[e(c,{onClick:l[14]||(l[14]=a=>g.value=!g.value)}),e(E,{title:"Edit Member Details"},{default:s(()=>[e(J,{ref_key:"editMemberForm",ref:$,onSubmit:K(le,["prevent"])},{default:s(()=>[e(_,null,{default:s(()=>[e(I,null,{default:s(()=>[e(n,{cols:"6"},{default:s(()=>[e(v,{modelValue:u.value.name_first,"onUpdate:modelValue":l[15]||(l[15]=a=>u.value.name_first=a),rules:["requiredValidator"in t?t.requiredValidator:o(d)],label:"First Name"},null,8,["modelValue","rules"])]),_:1}),e(n,{cols:"6"},{default:s(()=>[e(v,{modelValue:u.value.name_last,"onUpdate:modelValue":l[16]||(l[16]=a=>u.value.name_last=a),rules:["requiredValidator"in t?t.requiredValidator:o(d)],label:"Last Name"},null,8,["modelValue","rules"])]),_:1}),e(n,{cols:"6"},{default:s(()=>[e(v,{modelValue:u.value.email,"onUpdate:modelValue":l[17]||(l[17]=a=>u.value.email=a),rules:["requiredValidator"in t?t.requiredValidator:o(d),"emailValidator"in t?t.emailValidator:o(O)],label:"Email"},null,8,["modelValue","rules"])]),_:1}),e(n,{cols:"6"},{default:s(()=>[e(v,{modelValue:u.value.phone,"onUpdate:modelValue":l[18]||(l[18]=a=>u.value.phone=a),rules:["requiredValidator"in t?t.requiredValidator:o(d)],label:"Phone"},null,8,["modelValue","rules"])]),_:1}),e(n,{cols:"6"},{default:s(()=>[e(P,{modelValue:u.value.role,"onUpdate:modelValue":l[19]||(l[19]=a=>u.value.role=a),label:"Select Role",placeholder:"Select Role",rules:["requiredValidator"in t?t.requiredValidator:o(d)],items:z.value,"item-title":"name","item-value":"name"},null,8,["modelValue","rules","items"])]),_:1}),e(n,{cols:"6"},{default:s(()=>[e(P,{modelValue:u.value.state,"onUpdate:modelValue":l[20]||(l[20]=a=>u.value.state=a),label:"Select Status",placeholder:"Select Status",rules:["requiredValidator"in t?t.requiredValidator:o(d)],items:[{title:"Active",value:"active"},{title:"Inactive",value:"inactive"}],"item-title":"title","item-value":"value"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1}),e(_,{class:"d-flex justify-end gap-3 flex-wrap"},{default:s(()=>[e(M,{color:"secondary",onClick:l[21]||(l[21]=a=>g.value=!1)},{default:s(()=>[S(" Cancel ")]),_:1}),e(M,{type:"submit",onClick:l[22]||(l[22]=a=>{var w;return(w=$.value)==null?void 0:w.validate()})},{default:s(()=>[S(" Save ")]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(E,null,{default:s(()=>[e(_,{class:"d-flex justify-space-between align-center flex-wrap gap-4"},{default:s(()=>[Ie,Ee]),_:1}),e(ye),e(we,{headers:Z,"items-per-page":y.value.itemsPerPage,items:re.value,"item-value":"name","hide-default-footer":"",search:G.value,class:"text-no-wrap",density:"compact"},{"item.name":s(({item:a})=>[f("div",Ne,[e(Se,{size:"36",color:a.avatar?"":L(),class:Ce(a.avatar?"":"v-avatar-light-bg info--text"),variant:a.avatar?L():"tonal"},{default:s(()=>[f("span",null,q(("avatarText"in t?t.avatarText:o(_e))(a.name_first+" "+a.name_last)),1)]),_:2},1032,["color","class","variant"]),f("div",Te,[f("span",ze,q(a.name_first)+" "+q(a.name_last),1),f("small",Le,q(o(F).capitalizeFirstLetter(a.roles[0])),1)])])]),"item.email":s(({item:a})=>[f("div",Ye,[f("span",je,q(a.email),1)])]),"item.state":s(({item:a})=>[f("div",xe,[a.state=="active"?(D(),Q(W,{key:0,color:"success",variant:"outlined",size:"small"},{default:s(()=>[S(" Active ")]),_:1})):(D(),Q(W,{key:1,color:"error",variant:"outlined",size:"small"},{default:s(()=>[S(" Inactive ")]),_:1}))])]),"item.created_at":s(({item:a})=>[f("div",Je,[f("span",Ke,q(H(a)),1)])]),"item.actions":s(({item:a})=>[f("div",Oe,[e(Y,{onClick:w=>ae(a)},{default:s(()=>[e(N,{icon:"tabler-edit",color:"info"})]),_:2},1032,["onClick"]),e(Y,{onClick:w=>te(a)},{default:s(()=>[e(N,{icon:"tabler-trash",color:"error"})]),_:2},1032,["onClick"])])]),bottom:s(()=>[e(_,{class:"pt-2"},{default:s(()=>[V.value?(D(),j("div",Qe,[e(qe,{size:30,width:"3",indeterminate:"",color:"primary"})])):ke("",!0)]),_:1}),e(ne,{page:y.value.page,"onUpdate:page":[l[24]||(l[24]=a=>y.value.page=a),ie],"items-per-page":y.value.itemsPerPage,"total-items":T.value},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","items","search"])]),_:1})],64)}}},Ge=me(We,[["__scopeId","data-v-de8215d0"]]);export{Ge as default};
